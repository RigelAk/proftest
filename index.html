<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1, viewport-fit=cover, maximum-scale=1" name="viewport"/>
<title>–ü—Ä–æ—Ñ–¢–µ—Å—Ç ‚Äî by @Ave7Eva</title>
<meta content="@Ave7Eva" name="author"/>
<meta content="yes" name="apple-mobile-web-app-capable"/>
<meta content="#0b0d10" name="theme-color"/>
<style>
    :root{
      --bg:#0b0d10;--card:#12151a;--muted:#8a93a6;--text:#e8ecf1;--accent:#7c5cff;--accent-2:#2dd4bf;--accent-3:#f43f5e;--ok:#22c55e;--warn:#f59e0b;--err:#ef4444;--shadow:0 10px 30px rgba(0,0,0,.35);
      --safe-b: env(safe-area-inset-bottom); --safe-t: env(safe-area-inset-top);
    }
    *{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
    html{height:100%;-webkit-text-size-adjust:100%}
    body{min-height:100%;margin:0;background:linear-gradient(180deg,#0a0c0f,#0e1117 30%,#0a0c0f);color:var(--text);font:16px/1.5 'Gilroy', ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,Inter,"Helvetica Neue",Arial}
    .container{max-width:1100px;margin:0 auto;padding:24px}
    header{position:sticky;top:0;background:rgba(11,13,16,.7);backdrop-filter:blur(8px);-webkit-backdrop-filter:blur(8px);border-bottom:1px solid #1f2430;z-index:10}
    header .wrap{display:flex;gap:16px;align-items:center;justify-content:space-between;padding:12px 24px;padding-top:calc(12px + var(--safe-t))}
    .logo{display:flex;align-items:center;gap:12px}
    .logo .dot{width:12px;height:12px;border-radius:50%;background:radial-gradient(circle at 35% 35%,#fff, #b0a3ff 30%, #7c5cff)}
    .logo h1{font-size:18px;margin:0;font-weight:700;letter-spacing:.3px}
    .badge{font-size:12px;padding:4px 8px;border-radius:999px;background:rgba(124,92,255,.12);border:1px solid rgba(124,92,255,.35)}
    .grid{display:grid;gap:16px}
    .card{background:linear-gradient(180deg,#12151a,#0f1217);border:1px solid #1f2430;border-radius:16px;box-shadow:var(--shadow)}
    .card .inner{padding:20px}
    .title{font-size:22px;margin:0 0 12px;font-weight:800}
    .muted{color:var(--muted)}
    .row{display:flex;gap:12px;flex-wrap:wrap}
    .row.center{align-items:center}
    .btn{border:0;outline:0;cursor:pointer;padding:12px 18px;border-radius:12px;font-weight:700;letter-spacing:.2px;transition:transform .08s ease,box-shadow .2s ease}
    .btn.primary{background:linear-gradient(135deg,var(--accent),#9a85ff);color:#fff;box-shadow:0 8px 20px rgba(124,92,255,.35)}
    .btn.ghost{background:transparent;border:1px solid #2a3140;color:var(--text)}
    .btn:active{transform:scale(.98)}
    .progress{height:10px;background:#171b24;border-radius:999px;overflow:hidden}
    .progress > div{height:100%;background:linear-gradient(90deg,var(--accent),var(--accent-2));width:0%}

    /* Likert */
    .likert{display:grid;grid-template-columns:1fr minmax(240px,320px);gap:14px;align-items:center}
    .q{padding:14px 16px;border-radius:12px;background:rgba(255,255,255,.02);border:1px solid #1f2430}
    .scale{display:grid;grid-template-columns:repeat(7,1fr);gap:8px}
    .pill{position:relative}
    .pill input{appearance:none;width:100%;height:42px;background:#131822;border-radius:10px;border:1px solid #232a3a;cursor:pointer}
    .pill input:checked{outline:2px solid var(--accent);border-color:transparent}
    .pill label{position:absolute;inset:0;display:flex;align-items:center;justify-content:center;font-size:14px;color:#9aa3b7;pointer-events:none}
    .legend{display:flex;justify-content:space-between;font-size:12px;margin-top:8px;color:#9aa3b7}

    /* Pager ‚Äî –º–æ–±–∏–ª—å–Ω—ã–π –¥–æ–∫-–±–∞—Ä */
    .pager{display:flex;justify-content:space-between;align-items:center;padding:8px 0}
    .pager.mobile{position:sticky;bottom:0;left:0;right:0;padding:12px 16px;padding-bottom:calc(12px + var(--safe-b));background:rgba(10,12,15,.8);backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);border-top:1px solid #1f2430;z-index:15}
    .pager .btn{min-height:44px}
    .pager .btn.primary{flex:1}

    /* Results */
    .results{display:grid;grid-template-columns:1.2fr .8fr;gap:16px}
    .type-chip{display:inline-flex;gap:8px;align-items:center;padding:6px 10px;border-radius:999px;border:1px solid #2a3140;background:rgba(124,92,255,.08)}
    .bars{display:grid;gap:12px}
    .bar{display:grid;grid-template-columns:100px 1fr 60px;gap:12px;align-items:center}
    .bar .track{height:12px;background:#171b24;border-radius:999px;overflow:hidden}
    .bar .fill{height:100%;background:linear-gradient(90deg,var(--accent-2),#14b8a6)}
    .tag{display:inline-flex;padding:8px 12px;border-radius:999px;background:#151924;border:1px solid #21283a;color:#d0d6e4;font-size:13px;margin:4px}
    .two-col{display:grid;grid-template-columns:1fr 1fr;gap:16px}
    .jobs{display:grid;gap:8px}
    .job{display:grid;grid-template-columns:48px 1fr 72px;gap:10px;align-items:center;padding:10px;border:1px solid #262c3c;border-radius:12px;background:rgba(255,255,255,.02)}
    .job .p{height:10px;background:#171b24;border-radius:6px;overflow:hidden}
    .job .p>div{height:100%;background:linear-gradient(90deg,var(--accent),#a78bfa)}
    .note{font-size:12px;color:#9aa3b7}

    /* –ü–µ—á–∞—Ç–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ */
    .print-header{display:none}

    /* Cursor glow ‚Äî —Å–∫—Ä—ã–≤–∞–µ–º –Ω–∞ iPhone */
    .cursor{position:fixed;top:0;left:0;width:24px;height:24px;margin:-12px 0 0 -12px;border-radius:50%;pointer-events:none;background:radial-gradient(circle,#9a85ff 0,#7c5cff00 60%);mix-blend-mode:screen;opacity:.6;transition:transform .02s}
    @media (hover:none){.cursor{display:none}}

    /* iPhone / –º–∞–ª–µ–Ω—å–∫–∏–µ —ç–∫—Ä–∞–Ω—ã */
    @media (max-width: 640px){
      body{font-size:15px}
      .container{padding:16px}
      header .wrap{padding:10px 16px;padding-top:calc(10px + var(--safe-t))}
      .logo h1{font-size:16px}
      .title{font-size:20px}
      .card .inner{padding:16px}
      .likert{grid-template-columns:1fr}
      .results{grid-template-columns:1fr}
      .two-col{grid-template-columns:1fr}
      .bar{grid-template-columns:90px 1fr 48px}
      .scale{grid-template-columns:repeat(7, minmax(36px,1fr))}
      .pill input{height:40px;border-radius:12px}
      .pager{gap:8px}
      .row{gap:8px}
      .btn{padding:12px 14px;border-radius:14px}
    }

    /* –ü–µ—á–∞—Ç—å */
    @media print{
      @page{size:A4;margin:10mm}
      *{print-color-adjust:exact;-webkit-print-color-adjust:exact}
      body{background:#fff;color:#000;font-size:12px}
      header,#footer,.pager.mobile,#againBtn,#saveBtn,#prevBtn,#nextBtn,#restoreBtn,#startBtn,#intro,#quiz,.cursor{display:none!important}
      main.container{padding:0}
      .results{grid-template-columns:1fr;gap:8px}
      .card,.card .inner{background:#fff;border:0;box-shadow:none;padding:8px}
      .title{font-size:16px;margin:0 0 6px}
      h4{margin:8px 0 6px}
      p,li,.tag{font-size:12px}
      .print-header{display:block;margin:0 0 8px}
      .bar,.job{break-inside:avoid;page-break-inside:avoid}
      .two-col{grid-template-columns:1fr 1fr;gap:10px}
    }

    /* –£–≤–∞–∂–µ–Ω–∏–µ –∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è */
    @media (prefers-reduced-motion: reduce){ *{transition:none !important; animation:none !important} }

    /* ===== PDF composer styles (off-screen A4 sheet) ===== */
    #pdfSheet{
      position:fixed;left:-10000px;top:0;
      width:794px; /* A4 ~ 210mm @ 96dpi */
      padding:14px 18px;
      background:#0b0d10;color:#ffffff;
      font-family:Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Arial;
      line-height:1.35;
    }
    #pdfSheet .h1{font-size:18px;font-weight:800;margin:0 0 6px}
    #pdfSheet .sub{font-size:12px;color:#ffffff;margin:0 0 10px}
    #pdfSheet .chip{display:inline-flex;gap:8px;align-items:center;border:1px solid #e5e7eb;border-radius:999px;padding:4px 10px;font-weight:700}
    #pdfSheet .chip small{font-weight:600;opacity:.7}
    #pdfSheet .grid{display:grid;grid-template-columns:1.15fr .85fr;gap:10px}
    #pdfSheet .card{border:1px solid #e5e7eb;border-radius:10px;padding:10px}
    #pdfSheet h3{font-size:14px;margin:0 0 6px}
    #pdfSheet p, #pdfSheet li, #pdfSheet .tag{font-size:11px}
    #pdfSheet .tags{display:flex;flex-wrap:wrap;gap:6px}
    #pdfSheet .tag{display:inline-flex;border:1px solid #e5e7eb;border-radius:999px;background:#f8fafc;padding:4px 8px;color:#111}
    #pdfSheet .bars{display:grid;gap:6px}
    #pdfSheet .pbar{display:grid;grid-template-columns:1fr 34px;gap:6px;align-items:center}
    #pdfSheet .track{height:8px;background:#edf2f7;border-radius:999px;overflow:hidden}
    #pdfSheet .fill{height:100%;background:linear-gradient(90deg,#7c5cff,#2dd4bf);width:0%}
    #pdfSheet .jobs{display:grid;gap:6px}
    #pdfSheet .job{display:grid;grid-template-columns:1fr 26px;gap:8px;align-items:center}
    #pdfSheet .job .track{height:8px;background:#edf2f7;border-radius:999px;overflow:hidden}
    #pdfSheet .job .fill{height:100%;background:linear-gradient(90deg,#2dd4bf,#14b8a6);width:0%}
    #pdfSheet ul.compact{margin:0;padding-left:16px}
    #pdfSheet ul.compact li{margin:0 0 3px}
    #pdfSheet .cols2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    #pdfSheet .note{font-size:10px;color:#ffffff;margin-top:6px}

.note { color: #ffffff !important; }

#pdfSheet .sub, #pdfSheet .note{ color: #ffffff !important; }
</style>
<link href="https://cdn.jsdelivr.net/npm/font-gilroy/css/gilroy.css" rel="stylesheet"/></head>
<body>
<div aria-hidden="true" class="cursor"></div>
<header>
<div class="wrap">
<div class="logo">
<div aria-hidden="true" class="dot"></div>
<h1>–ü—Ä–æ—Ñ–¢–µ—Å—Ç</h1>
<span class="badge">–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –¢–µ—Å—Ç</span>
</div>
<div class="muted">–ê–≤—Ç–æ—Ä: <strong>@Ave7Eva</strong></div>
</div>
</header>
<main class="container">
<section class="grid" id="intro">
<div class="card">
<div class="inner">
<h2 class="title">–ù–∞–π–¥—ë–º –≤–∞—à —Ä–∞–±–æ—á–∏–π —Å—Ç–∏–ª—å –∏ —Å–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã</h2>
<p class="muted">–û—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –ø–æ —à–∫–∞–ª–µ –æ—Ç ¬´—Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ –Ω–µ —Å–æ–≥–ª–∞—Å–µ–Ω¬ª –¥–æ ¬´–ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≥–ª–∞—Å–µ–Ω¬ª. –¢–µ—Å—Ç —Ä–∞—Å—Å—á–∏—Ç–∞–Ω –Ω–∞ 10‚Äì12 –º–∏–Ω—É—Ç –∏ –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç 4 –æ—Å–∏: –æ–±—â–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, —Å–ø–æ—Å–æ–± –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, —Å—Ç–∏–ª—å —Ä–µ—à–µ–Ω–∏–π –∏ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫ –ø–ª–∞–Ω—É.</p>
<div class="row">
<label class="q" style="flex:1;min-width:220px">
<div class="muted" style="margin-bottom:6px">–í–∞—à–µ –∏–º—è (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</div>
<input id="userName" inputmode="text" placeholder="–ö–∞–∫ –≤–∞—Å –Ω–∞–∑—ã–≤–∞—Ç—å?" style="width:100%;padding:14px;border-radius:14px;border:1px solid #283144;background:#0e1320;color:var(--text)"/>
</label>
<button class="btn primary" id="startBtn" type="button">–ù–∞—á–∞—Ç—å —Ç–µ—Å—Ç</button>
<button class="btn ghost" id="restoreBtn" title="–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å –º–µ—Å—Ç–∞, –≥–¥–µ –æ—Å—Ç–∞–Ω–æ–≤–∏–ª–∏—Å—å" type="button">–í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
</div>
<p class="note">–î–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ. –ò—Ö –º–æ–∂–Ω–æ —Å—Ç–µ—Ä–µ—Ç—å –≤ –ª—é–±–æ–µ –≤—Ä–µ–º—è.</p>
</div>
</div>
</section>
<section class="grid" hidden="" id="quiz">
<div class="card">
<div class="inner">
<div class="row center" style="justify-content:space-between">
<div class="muted">–®–∞–≥ <span id="stepNow">1</span>/<span id="stepAll">1</span></div>
<div aria-label="–ü—Ä–æ–≥—Ä–µ—Å—Å" class="progress" style="min-width:160px;width:45%"><div id="progressFill"></div></div>
</div>
</div>
</div>
<div class="grid" id="questionsWrap"></div>
<div class="pager mobile">
<button class="btn ghost" id="prevBtn" type="button">‚Üê –ù–∞–∑–∞–¥</button>
<div class="row" style="flex:1;justify-content:flex-end">
<button class="btn ghost" id="saveBtn" title="–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å" type="button">üíæ</button>
<button class="btn primary" id="nextBtn" type="button">–î–∞–ª–µ–µ ‚Üí</button>
</div>
</div>
</section>
<section class="grid" hidden="" id="results">
<!-- –ü–µ—á–∞—Ç–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫ -->
<div class="print-header">
<h2 style="margin:0">–ü—Ä–æ—Ñ–¢–µ—Å—Ç ‚Äî –†–µ–∑—É–ª—å—Ç–∞—Ç—ã</h2>
<div class="muted">–ò–º—è: <strong id="printName">‚Äî</strong> ¬∑ –î–∞—Ç–∞: <span id="printDate"></span></div>
</div>
<div class="results">
<div class="card">
<div class="inner">
<h3 class="title" id="typeTitle">–í–∞—à —Ç–∏–ø</h3>
<div class="row center" style="gap:10px;margin-bottom:12px">
<span class="type-chip"><strong id="typeCode">‚Äî</strong><span id="typeName"></span></span>
<span class="tag" id="tagline">–û–ø–∏—Å–∞–Ω–∏–µ</span>
</div>
<p class="muted" id="personLine" style="margin-top:-6px">–ò–º—è: <strong id="personName">‚Äî</strong></p>
<p id="summary" style="margin-top:0"></p>
<div class="two-col">
<div>
<h4>–†–∞–∑–ª–æ–∂–µ–Ω–∏–µ –ø–æ –æ—Å—è–º</h4>
<div class="bars" id="axesBars"></div>
</div>
<div>
<h4>–ö–ª—é—á–µ–≤—ã–µ –∫–∞—á–µ—Å—Ç–≤–∞</h4>
<div class="row" id="strengths"></div>
</div>
</div>
<h4 style="margin-top:18px">–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–≤–µ—Ç—ã</h4>
<ul id="advice"></ul>
<div class="row" style="gap:10px;margin-top:10px">
<button class="btn primary" id="printBtn" type="button">–°–∫–∞—á–∞—Ç—å/—Ä–∞—Å–ø–µ—á–∞—Ç–∞—Ç—å</button>
<button class="btn ghost" id="againBtn" type="button">–ü—Ä–æ–π—Ç–∏ –∑–∞–Ω–æ–≤–æ</button>
</div>
</div>
</div>
<div class="card">
<div class="inner">
<h4 class="title">–ü—Ä–æ—Ñ–Ω–∞–≤–∏–≥–∞—Ü–∏—è</h4>
<p class="muted" style="margin-top:-6px">–ü–æ–¥–±–æ—Ä–∫–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π –∏ —Å—Ä–µ–¥, –≥–¥–µ –≤–∞—à —Å—Ç–∏–ª—å –æ—Å–æ–±–µ–Ω–Ω–æ —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è. –ü—Ä–æ—Ü–µ–Ω—Ç—ã = —Å—Ç–µ–ø–µ–Ω—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è.</p>
<div class="jobs" id="jobs"></div>
<div class="row" id="envTags" style="margin-top:6px"></div>
<p class="note">–ü–æ–¥–±–æ—Ä–∫–∞ –Ω–æ—Å–∏—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—ã–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä. –£—Ç–æ—á–Ω—è–π—Ç–µ –µ—ë —Ä–µ–∞–ª—å–Ω—ã–º–∏ –∑–∞–¥–∞—á–∞–º–∏ –∏ —Ä—ã–Ω–∫–æ–º.</p>
</div>
</div>
</div>
<div class="card">
<div class="inner">
<h4 class="title">–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π —Ä–∞–∑–±–æ—Ä –æ—Ç–≤–µ—Ç–æ–≤</h4>
<div id="deepDive"></div>
</div>
</div>
</section>
<section class="grid" id="footer" style="margin-top:16px">
<div class="card"><div class="inner"><div class="row center" style="justify-content:space-between"><span class="muted">¬© <span id="year"></span> –ê–≤—Ç–æ—Ä: <strong>@Ave7Eva</strong></span><button class="btn ghost" id="wipeBtn" type="button">–û—á–∏—Å—Ç–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</button></div></div></div>
</section>
</main>
<script>
  // ===== iOS helpers =====
  const isIOS = /iPhone|iPad|iPod/i.test(navigator.userAgent);
  if(isIOS){
    // –£–±–∏—Ä–∞–µ–º –∑–∞–¥–µ—Ä–∂–∫—É –∫–ª–∏–∫–∞ –Ω–∞ iOS Safari
    document.addEventListener('touchend',()=>{}, {passive:true});
  }

  // ===== Fancy cursor glow (–æ—Ç–∫–ª—é—á–∞–µ–º –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö –±–µ–∑ hover) =====
  const cursor = document.querySelector('.cursor');
  if(matchMedia('(hover:hover)').matches){
    window.addEventListener('pointermove', (e)=>{ cursor.style.transform = `translate(${e.clientX}px, ${e.clientY}px)`; });
  }

  // ===== Utils =====
  const $ = (sel,root=document)=>root.querySelector(sel);
  const $$ = (sel,root=document)=>Array.from(root.querySelectorAll(sel));
  const clamp = (n,min=0,max=100)=>Math.max(min,Math.min(max,n));
  const seedRand = (seed)=>{ let x = 0; for (let i=0;i<seed.length;i++) x ^= seed.charCodeAt(i) << (i%8); return ()=>{x ^= x<<13; x ^= x>>>17; x ^= x<<5; return ((x>>>0)%1000)/1000}; };

  // ===== Data model =====
  const AXES = [
    {pos:'E',neg:'I', name:['–≠–∫—Å—Ç—Ä–∞–≤–µ—Ä—Å–∏—è','–ò–Ω—Ç—Ä–æ–≤–µ—Ä—Å–∏—è']},
    {pos:'S',neg:'N', name:['–°–µ–Ω—Å–æ—Ä–∏–∫–∞','–ò–Ω—Ç—É–∏—Ü–∏—è']},
    {pos:'F',neg:'T', name:['–ß—É–≤—Å—Ç–≤–æ','–õ–æ–≥–∏–∫–∞']},
    {pos:'P',neg:'J', name:['–í–æ—Å–ø—Ä–∏—è—Ç–∏–µ','–°—É–∂–¥–µ–Ω–∏–µ']},
  ];

  // 48 —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–π
  const QUESTIONS = [
    // E / I
    {axis:'E',key:+1,facet:'–æ–±—â–µ–Ω–∏–µ',text:'–ú–Ω–µ –ª–µ–≥–∫–æ –∑–∞–≤–æ–¥–∏—Ç—å —Ä–∞–∑–≥–æ–≤–æ—Ä —Å –Ω–µ–∑–Ω–∞–∫–æ–º—Ü–∞–º–∏ –∏ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –µ–≥–æ –±–µ–∑ –ø–∞—É–∑.'},
    {axis:'E',key:+1,facet:'—ç–Ω–µ—Ä–≥–∏—è', text:'–ì—Ä–æ–º–∫–∏–µ –∏ –∂–∏–≤—ã–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –º–µ–Ω—è –∑–∞—Ä—è–∂–∞—é—Ç, –∞ –Ω–µ —É—Ç–æ–º–ª—è—é—Ç.'},
    {axis:'E',key:+1,facet:'–≤–ª–∏—è–Ω–∏–µ', text:'–Ø —á–∞—Å—Ç–æ —Å—Ç–∞–Ω–æ–≤–ª—é—Å—å —Ü–µ–Ω—Ç—Ä–æ–º –≤–Ω–∏–º–∞–Ω–∏—è –≤ –∫–æ–º–ø–∞–Ω–∏–∏.'},
    {axis:'E',key:+1,facet:'–∫–æ–º–∞–Ω–¥–Ω–æ—Å—Ç—å', text:'–õ—é–±–ª—é —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –∫–æ–º–∞–Ω–¥–∞—Ö –∏ –±—ã—Å—Ç—Ä–æ —á—É–≤—Å—Ç–≤—É—é –∞—Ç–º–æ—Å—Ñ–µ—Ä—É –≥—Ä—É–ø–ø—ã.'},
    {axis:'E',key:+1,facet:'—ç–∫—Å–ø—Ä–æ–º—Ç', text:'–ò–º–ø—Ä–æ–≤–∏–∑–∞—Ü–∏—è –¥–∞—ë—Ç—Å—è –ª–µ–≥–∫–æ; –ø–ª–∞–Ω –Ω—É–∂–µ–Ω —Å–∫–æ—Ä–µ–µ –∫–∞–∫ –æ—Ä–∏–µ–Ω—Ç–∏—Ä.'},
    {axis:'E',key:+1,facet:'–¥–∏–ø–ª–æ–º–∞—Ç–∏—è',text:'–£–º–µ—é —Ä–∞–∑—Ä—è–¥–∏—Ç—å –Ω–∞–ø—Ä—è–∂—ë–Ω–Ω—ã–π —Ä–∞–∑–≥–æ–≤–æ—Ä —à—É—Ç–∫–æ–π –∏–ª–∏ —Ç—ë–ø–ª–æ–π —Ä–µ–ø–ª–∏–∫–æ–π.'},
    {axis:'E',key:-1,facet:'–ø–µ—Ä–µ–∑–∞—Ä—è–¥–∫–∞',text:'–ü–æ—Å–ª–µ –¥–ª–∏–Ω–Ω–æ–≥–æ –¥–Ω—è –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é –æ–¥–∏–Ω–æ—á–µ—Å—Ç–≤–æ –¥–∞–∂–µ –±–æ–ª—å—à–µ, —á–µ–º –±–µ—Å–µ–¥—É.'},
    {axis:'E',key:-1,facet:'—Ñ–æ–∫—É—Å',    text:'–í —à—É–º–Ω–æ–π —Å—Ä–µ–¥–µ –º–Ω–µ —Å–ª–æ–∂–Ω–æ –¥—É–º–∞—Ç—å –∏ —Ä–∞–±–æ—Ç–∞—Ç—å.'},
    {axis:'E',key:-1,facet:'—Å–µ–ª—Ñ—Ç–∞–π–º', text:'–õ—É—á—à–∏–µ –∏–¥–µ–∏ –ø—Ä–∏—Ö–æ–¥—è—Ç, –∫–æ–≥–¥–∞ —è –æ–¥–∏–Ω/–æ–¥–Ω–∞ –∏ –º–µ–Ω—è –Ω–∏–∫—Ç–æ –Ω–µ –æ—Ç–≤–ª–µ–∫–∞–µ—Ç.'},
    {axis:'E',key:-1,facet:'–≥–ª—É–±–∏–Ω–∞',  text:'–û–¥–∏–Ω –≥–ª—É–±–æ–∫–∏–π —Ä–∞–∑–≥–æ–≤–æ—Ä —Ü–µ–Ω–Ω–µ–µ –¥–ª—è –º–µ–Ω—è, —á–µ–º –º–Ω–æ–≥–æ –∫–æ—Ä–æ—Ç–∫–∏—Ö.'},
    {axis:'E',key:-1,facet:'—ç–∫–æ–Ω–æ–º–∏—è', text:'–Ø –∏–∑–±–µ–≥–∞—é –ª–∏—à–Ω–∏—Ö –≤—Å—Ç—Ä–µ—á –∏ –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é –æ–±—â–∞—Ç—å—Å—è –ø–æ –¥–µ–ª—É.'},
    {axis:'E',key:-1,facet:'–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ',text:'–ß–∞—â–µ –Ω–∞–±–ª—é–¥–∞—é —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã, —á–µ–º –≤—Å—Ç—É–ø–∞—é –≤ —Ä–∞–∑–≥–æ–≤–æ—Ä –ø–µ—Ä–≤—ã–º(–æ–π).'},

    // S / N
    {axis:'S',key:+1,facet:'–Ω–∞–±–ª—é–¥',  text:'–ë—ã—Å—Ç—Ä–æ –∑–∞–º–µ—á–∞—é –¥–µ—Ç–∞–ª–∏: –∑–∞–ø–∞—Ö–∏, —Ü–≤–µ—Ç–∞, –º–µ–ª–∫–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–æ–∫—Ä—É–≥.'},
    {axis:'S',key:+1,facet:'–ø—Ä–∞–∫—Ç–∏–∫–∞',text:'–ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∏ –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫—É –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–º –∏–¥–µ—è–º.'},
    {axis:'S',key:+1,facet:'—Ä–µ–∞–ª–∏–∑–º', text:'–°–∫–µ–ø—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–Ω–æ—à—É—Å—å –∫ —Ç–µ–æ—Ä–∏—è–º –±–µ–∑ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏.'},
    {axis:'S',key:+1,facet:'—Ä—É—Ç–∏–Ω–∞',  text:'–ü–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –∑–∞–¥–∞—á–∏ –Ω–µ –ø—É–≥–∞—é—Ç, –µ—Å–ª–∏ –æ–Ω–∏ –¥–∞—é—Ç —Å—Ç–∞–±–∏–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç.'},
    {axis:'S',key:+1,facet:'—Ç–æ—á–Ω–æ—Å—Ç—å',text:'–õ—é–±–ª—é –∞–∫–∫—É—Ä–∞—Ç–Ω–æ—Å—Ç—å –∏ —è—Å–Ω–æ—Å—Ç—å –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞—Ö.'},
    {axis:'S',key:+1,facet:'–æ–ø—ã—Ç',    text:'–û–ø–∏—Ä–∞—é—Å—å –Ω–∞ –ø—Ä–æ—à–ª—ã–π –æ–ø—ã—Ç –±–æ–ª—å—à–µ, —á–µ–º –Ω–∞ –∏–Ω—Ç—É–∏—Ü–∏—é.'},
    {axis:'S',key:-1,facet:'–≤–∏–¥–µ–Ω–∏–µ', text:'–ß–∞—Å—Ç–æ –≤–∏–∂—É —Å–∫—Ä—ã—Ç—ã–µ —Å–≤—è–∑–∏ –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ –¥—Ä—É–≥–∏–µ –Ω–µ –∑–∞–º–µ—á–∞—é—Ç.'},
    {axis:'S',key:-1,facet:'–≥–∏–ø–æ—Ç–µ–∑—ã', text:'–§–∞–Ω—Ç–∞–∑–∏—Ä–æ–≤–∞—Ç—å –æ –±—É–¥—É—â–µ–º —É –º–µ–Ω—è –ø–æ–ª—É—á–∞–µ—Ç—Å—è –ª–µ–≥—á–µ, —á–µ–º –æ–ø–∏—Å—ã–≤–∞—Ç—å –Ω–∞—Å—Ç–æ—è—â–µ–µ.'},
    {axis:'S',key:-1,facet:'–∏–Ω—Å–∞–π—Ç',  text:'–ò–¥–µ–∏ –≤—Å–ø—ã—Ö–∏–≤–∞—é—Ç –≤–Ω–µ–∑–∞–ø–Ω–æ, –±–µ–∑ –ø–æ—à–∞–≥–æ–≤–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞.'},
    {axis:'S',key:-1,facet:'—Ä–∏—Å–∫–∏',   text:'–ì–æ—Ç–æ–≤(–∞) –ø—Ä–æ–±–æ–≤–∞—Ç—å –Ω–æ–≤–æ–µ, –¥–∞–∂–µ –µ—Å–ª–∏ –ø–ª–∞–Ω–∞ –µ—â—ë –Ω–µ—Ç.'},
    {axis:'S',key:-1,facet:'–º–µ—Ç–∞—Ñ–æ—Ä—ã',text:'–õ—é–±–ª—é –º–µ—Ç–∞—Ñ–æ—Ä—ã, –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏, –±–æ–ª—å—à–∏–µ –∫–∞—Ä—Ç–∏–Ω—ã.'},
    {axis:'S',key:-1,facet:'–≤–∞—Ä–∏–∞–Ω—Ç—ã',text:'–ß–∞—Å—Ç–æ –≥–µ–Ω–µ—Ä–∏—Ä—É—é –º–Ω–æ–∂–µ—Å—Ç–≤–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –≤–º–µ—Å—Ç–æ –æ–¥–Ω–æ–π ¬´–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π¬ª –∏–¥–µ–∏.'},

    // F / T
    {axis:'F',key:+1,facet:'—ç–º–ø–∞—Ç–∏—è', text:'–õ–µ–≥–∫–æ —á—É–≤—Å—Ç–≤—É—é —ç–º–æ—Ü–∏–∏ –ª—é–¥–µ–π –∏ —Å—Ç–∞—Ä–∞—é—Å—å –ø–æ–¥–¥–µ—Ä–∂–∞—Ç—å.'},
    {axis:'F',key:+1,facet:'–≥–∞—Ä–º–æ–Ω–∏—è',text:'–ò–∑–±–µ–≥–∞—é –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –∏ –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é –º—è–≥–∫–∏–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏.'},
    {axis:'F',key:+1,facet:'—Ü–µ–Ω–Ω–æ—Å—Ç–∏',text:'–ü—Ä–∏–Ω–∏–º–∞—è —Ä–µ—à–µ–Ω–∏—è, —É—á–∏—Ç—ã–≤–∞—é –≤–ª–∏—è–Ω–∏–µ –Ω–∞ –ª—é–¥–µ–π, –∞ –Ω–µ —Ç–æ–ª—å–∫–æ —Ü–∏—Ñ—Ä—ã.'},
    {axis:'F',key:+1,facet:'–æ–±—Ä–∞—Ç–Ω–∞—è',text:'–ö—Ä–∏—Ç–∏–∫–∞ –º–æ–∂–µ—Ç –∑–∞–¥–µ–≤–∞—Ç—å –º–µ–Ω—è —Å–∏–ª—å–Ω–µ–µ, —á–µ–º —Ö–æ—Ç–µ–ª–æ—Å—å –±—ã.'},
    {axis:'F',key:+1,facet:'–¥–æ–±—Ä–æ—Ç–∞', text:'–°—Ç–∞—Ä–∞—é—Å—å –±–ª–∞–≥–æ–¥–∞—Ä–∏—Ç—å –∏ —Ö–≤–∞–ª–∏—Ç—å —á–∞—â–µ, —á–µ–º —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–∞ –æ—à–∏–±–∫–∏.'},
    {axis:'F',key:+1,facet:'–º–æ—Ä–∞–ª—å',  text:'–ß–µ—Å—Ç–Ω–æ—Å—Ç—å –∏ –∑–∞–±–æ—Ç–∞ –≤–∞–∂–Ω–µ–µ –≤—ã–∏–≥—Ä—ã—à–∞ –ª—é–±–æ–π —Ü–µ–Ω–æ–π.'},
    {axis:'F',key:-1,facet:'—Ä–∞—Ü–∏–æ–Ω–∞–ª',text:'–í —Å–ø–æ—Ä–µ –æ–ø–∏—Ä–∞—é—Å—å –Ω–∞ –ª–æ–≥–∏–∫—É, –¥–∞–Ω–Ω—ã–µ –∏ –ø—Ä–∏—á–∏–Ω–Ω–æ-—Å–ª–µ–¥—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–≤—è–∑–∏.'},
    {axis:'F',key:-1,facet:'–ø—Ä—è–º–æ—Ç–∞', text:'–ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é –≥–æ–≤–æ—Ä–∏—Ç—å –ø—Ä—è–º–æ, –¥–∞–∂–µ –µ—Å–ª–∏ —ç—Ç–æ –∫–æ–º—É-—Ç–æ –Ω–µ–ø—Ä–∏—è—Ç–Ω–æ.'},
    {axis:'F',key:-1,facet:'—Å–ø—Ä–∞–≤–µ–¥–ª',text:'–†–∞–≤–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è –≤—Å–µ—Ö –≤–∞–∂–Ω–µ–µ –∏—Å–∫–ª—é—á–µ–Ω–∏–π –∏–∑ —Å–æ—Å—Ç—Ä–∞–¥–∞–Ω–∏—è.'},
    {axis:'F',key:-1,facet:'—Ö–æ–ª–æ–¥–æ–∫', text:'–ú–æ–≥—É –æ—Ç–¥–µ–ª—è—Ç—å —ç–º–æ—Ü–∏–∏ –æ—Ç —Ä–µ—à–µ–Ω–∏—è, –µ—Å–ª–∏ —Å–∏—Ç—É–∞—Ü–∏—è —Ç—Ä–µ–±—É–µ—Ç —Å—Ç—Ä–æ–≥–æ—Å—Ç–∏.'},
    {axis:'F',key:-1,facet:'–¥–µ–±–∞—Ç—ã',  text:'–õ—é–±–ª—é –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–∏–≤–Ω—ã–µ —Å–ø–æ—Ä—ã: —Ç–∞–∫ –±—ã—Å—Ç—Ä–µ–µ –Ω–∞—Ö–æ–¥–∏–º –∏—Å—Ç–∏–Ω—É.'},
    {axis:'F',key:-1,facet:'—Ç–æ—á–Ω–æ—Å—Ç—å',text:'–î—Ä–∞–∑–Ω–∏—Ç, –∫–æ–≥–¥–∞ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –ø–æ–¥–º–µ–Ω—è—é—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ–º –∏–ª–∏ ¬´–æ—â—É—â–µ–Ω–∏—è–º–∏¬ª.'.replace('¬´','"').replace('¬ª','"')},

    // P / J
    {axis:'P',key:+1,facet:'–≥–∏–±–∫–æ—Å—Ç—å',text:'–û—Å—Ç–∞–≤–ª—è—é –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –¥–ª—è —Å–ø–æ–Ω—Ç–∞–Ω–Ω–æ—Å—Ç–∏ –∏ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π.'},
    {axis:'P',key:+1,facet:'–ª–µ–≥–∫–æ—Å—Ç—å',text:'–†–µ–≥–ª–∞–º–µ–Ω—Ç—ã –∏ –∂—ë—Å—Ç–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞ –±—ã—Å—Ç—Ä–æ —É—Ç–æ–º–ª—è—é—Ç.'},
    {axis:'P',key:+1,facet:'–∞–¥–∞–ø—Ç',   text:'–ë—ã—Å—Ç—Ä–æ –ø–µ—Ä–µ—Å—Ç—Ä–∞–∏–≤–∞—é—Å—å –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –ø–ª–∞–Ω–æ–≤.'},
    {axis:'P',key:+1,facet:'–ø–µ—Ä–µ–∫–ª—é—á',text:'–õ—é–±–ª—é –¥–µ–ª–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–µ—â–µ–π –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ.'},
    {axis:'P',key:+1,facet:'–∏–º–ø—É–ª—å—Å', text:'–ò–Ω–æ–≥–¥–∞ –¥–µ–π—Å—Ç–≤—É—é –ø–æ –Ω–∞–∏—Ç–∏—é ‚Äî –∏ —á–∞—Å—Ç–æ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç.'},
    {axis:'P',key:+1,facet:'—Å—Ä–æ–∫–∏',   text:'–ö –¥–µ–¥–ª–∞–π–Ω–∞–º –ø—Ä–∏—Ö–æ–∂—É –≤ —Ä–µ–∂–∏–º–µ ¬´—Å–ø—Ä–∏–Ω—Ç–∞¬ª –±–ª–∏–∂–µ –∫ —Ñ–∏–Ω–∏—à—É.'},
    {axis:'P',key:-1,facet:'—Å—Ç—Ä—É–∫—Ç—É—Ä–∞',text:'–ü–æ–ª—É—á–∞—é —É–¥–æ–≤–æ–ª—å—Å—Ç–≤–∏–µ –æ—Ç —Å–ø–∏—Å–∫–æ–≤, –¥–µ–¥–ª–∞–π–Ω–æ–≤ –∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–¥–∞—á.'},
    {axis:'P',key:-1,facet:'–ø—Ä–µ–¥—Å–∫–∞–∑',text:'–ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é –ø–ª–∞–Ω –Ω–∞ –Ω–µ–¥–µ–ª—é –≤–ø–µ—Ä—ë–¥ –∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–∏.'},
    {axis:'P',key:-1,facet:'–º–æ–Ω–æ—Ç–∞—Å–∫',text:'–õ—É—á—à–µ –¥–µ–ª–∞—é –æ–¥–Ω–æ –¥–µ–ª–æ, –¥–æ–≤–æ–¥—è –µ–≥–æ –¥–æ –∫–æ–Ω—Ü–∞.'},
    {axis:'P',key:-1,facet:'–∫–æ–Ω—Ç—Ä–æ–ª—å',text:'–ö–æ–º—Ñ–æ—Ä—Ç–Ω–µ–µ, –∫–æ–≥–¥–∞ –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–¥ –∫–æ–Ω—Ç—Ä–æ–ª–µ–º –∏ –º–∞–ª–æ —Å—é—Ä–ø—Ä–∏–∑–æ–≤.'},
    {axis:'P',key:-1,facet:'—Å–∏—Å—Ç–µ–º–Ω', text:'–°–∏—Å—Ç–µ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∏ –ø–æ—Ä—è–¥–æ–∫ –ø–æ–º–æ–≥–∞—é—Ç –º–Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Ñ–æ–∫—É—Å.'},
    {axis:'P',key:-1,facet:'—Ä–∞–Ω–Ω–∏–π—Å—Ç–∞—Ä—Ç',text:'–ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é –Ω–∞—á–∏–Ω–∞—Ç—å –∑–∞—Ä–∞–Ω–µ–µ, –∞ –Ω–µ –æ—Ç–∫–ª–∞–¥—ã–≤–∞—Ç—å –¥–æ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ.'},
  ];

  const PAGE_SIZE = 6; const STEPS = Math.ceil(QUESTIONS.length / PAGE_SIZE);

  const TYPE_NAMES = {
    'ESFP':'–î—É—à–∞ –∫–æ–º–ø–∞–Ω–∏–∏', 'ESFJ':'–ù–∞—Å—Ç–∞–≤–Ω–∏–∫', 'ESTP':'–ú–∞—Ä—à–∞–ª –¥–µ–π—Å—Ç–≤–∏–π', 'ESTJ':'–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä',
    'ENFP':'–í–¥–æ—Ö–Ω–æ–≤–∏—Ç–µ–ª—å',  'ENFJ':'–û–±—ä–µ–¥–∏–Ω–∏—Ç–µ–ª—å', 'ENTP':'–ò–∑–æ–±—Ä–µ—Ç–∞—Ç–µ–ª—å',  'ENTJ':'–û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä',
    'ISFP':'–¢–æ–Ω–∫–∏–π —Å—Ç–∏–ª–∏—Å—Ç', 'ISFJ':'–û–ø–µ–∫—É–Ω', 'ISTP':'–ú–∞—Å—Ç–µ—Ä-–ø—Ä–∞–∫—Ç–∏–∫', 'ISTJ':'–ê—É–¥–∏—Ç–æ—Ä',
    'INFP':'–ò–¥–µ–∞–ª–∏—Å—Ç', 'INFJ':'–°–æ–≤–µ—Ç–Ω–∏–∫', 'INTP':'–ú—ã—Å–ª–∏—Ç–µ–ª—å', 'INTJ':'–°—Ç—Ä–∞—Ç–µ–≥'
  };

  const TAGLINES = { ESFP:['–ü—Ä–∞–∑–¥–Ω–∏–∫ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å','–¢—ë–ø–ª—ã–π –¥–≤–∏–≥–∞—Ç–µ–ª—å –∫–æ–º–∞–Ω–¥—ã','–≠–Ω–µ—Ä–≥–∏—è –∑–¥–µ—Å—å‚Äë–∏‚Äë—Å–µ–π—á–∞—Å'], ENFP:['–ò—Å–∫—Ä—ã –∏–¥–µ–π','–°–≤—è–∑—ã–≤–∞–µ—Ç –ª—é–¥–µ–π –∏ —Å–º—ã—Å–ª—ã'], ENFJ:['–°–æ–±–∏—Ä–∞–µ—Ç –≤—Å–µ—Ö –≤ –æ—Ä–±–∏—Ç—É','–î–∏–ø–ª–æ–º–∞—Ç –∏ –º–æ—Ç–∏–≤–∞—Ç–æ—Ä'], ENTJ:['–°–º—ã—Å–ª ‚Üí —Å—Ç—Ä–∞—Ç–µ–≥–∏—è ‚Üí —Ä–µ–∑—É–ª—å—Ç–∞—Ç'], ENTP:['–°–ø—Ä–∞—à–∏–≤–∞–µ—Ç ¬´–ø–æ—á–µ–º—É –Ω–µ—Ç?¬ª','–ò–≥—Ä–∞–µ—Ç –∏–¥–µ—è–º–∏'], ESTP:['–î–µ–π—Å—Ç–≤—É–π —Å–µ–π—á–∞—Å','–†–µ—à–∞–µ—Ç –Ω–∞ –º–µ—Å—Ç–µ'], ESTJ:['–ü—Ä–æ—Ü–µ—Å—Å—ã –≤ –ø–æ—Ä—è–¥–∫–µ'], ESFJ:['–ó–∞–±–æ—Ç–∞ –∫–∞–∫ —Å–∏—Å—Ç–µ–º–∞'], ISFP:['–¢–∏—Ö–∞—è —ç—Å—Ç–µ—Ç–∏–∫–∞'], ISFJ:['–ù–∞–¥—ë–∂–Ω–æ–µ –ø–ª–µ—á–æ'], ISTP:['–ò–Ω–∂–µ–Ω–µ—Ä —Ö–∞–∫–∏–Ω–≥–∞ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏'], ISTJ:['–ú–µ—Ç–æ–¥ –∏ –ø–æ—Ä—è–¥–æ–∫'], INFP:['–¶–µ–Ω–Ω–æ—Å—Ç–∏ –∏ —Å–º—ã—Å–ª'], INFJ:['–ì–ª—É–±–∏–Ω–∞ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞'], INTP:['–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è –º—ã—Å–ª–∏'], INTJ:['–ü–ª–∞–Ω 1‚Äì3‚Äì5 –ª–µ—Ç'] };

  const ESFP_DETAIL = { strengths:['–ü–æ–∑–∏—Ç–∏–≤ –∏ —É–º–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ–∂–∞—Ç—å –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ','–í—ã—Å–æ–∫–∞—è —ç–º–ø–∞—Ç–∏—è –∏ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫ –ª—é–¥—è–º','–ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º','–û—Ç–ª–∏—á–Ω–æ–µ —á—É–≤—Å—Ç–≤–æ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏ –∏ —Ç—Ä–µ–Ω–¥–æ–≤'], growth:['–¢—Ä–µ–Ω–∏—Ä—É–π—Ç–µ —Å–ø–æ–∫–æ–π–Ω—ã–π —Ä–∞–∑–≥–æ–≤–æ—Ä –æ —Å–ª–æ–∂–Ω–æ–º: ¬´–Ø –≤–∏–∂—É —Ç–∞–∫‚Ä¶ –¥–∞–≤–∞–π –æ–±—Å—É–¥–∏–º¬ª','–ü–µ—Ä–µ–¥ –≤–∞–∂–Ω—ã–º —Ä–µ—à–µ–Ω–∏–µ–º ‚Äî 10 –º–∏–Ω—É—Ç ¬´—Ö–æ–ª–æ–¥–Ω–æ–π –≥–æ–ª–æ–≤—ã¬ª: –ø–ª—é—Å—ã/–º–∏–Ω—É—Å—ã, —Ä–∏—Å–∫–∏, –ø–ª–∞–Ω –ë','–ë–æ–ª—å—à–∏–µ —Ü–µ–ª–∏ ‚Äî –≤ –º–∞–ª–µ–Ω—å–∫–∏–µ —à–∞–≥–∏ —Å –¥–∞—Ç–∞–º–∏ –∏ —á–µ–∫‚Äë–ª–∏—Å—Ç–∞–º–∏','–¢–µ—Ä–ø–µ–Ω–∏–µ –∫ —á—É–∂–∏–º –æ—à–∏–±–∫–∞–º: ¬´–Ω–µ–æ—á–µ–≤–∏–¥–Ω–æ–µ –¥–ª—è –º–µ–Ω—è –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–æ–≤—ã–º –¥–ª—è –¥—Ä—É–≥–∏—Ö¬ª'], env:['–î–∏–Ω–∞–º–∏–∫–∞ –∏ –æ–±—â–µ–Ω–∏–µ','–ú–∏–Ω–∏–º—É–º –±—é—Ä–æ–∫—Ä–∞—Ç–∏–∏','–¢–≤–æ—Ä—á–µ—Å–∫–∞—è —Å–≤–æ–±–æ–¥–∞','–¢—ë–ø–ª–∞—è –∫–æ–º–∞–Ω–¥–∞'], jobs:[{name:'HR‚Äë—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç',score:90},{name:'–ì—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –¥–∏–∑–∞–π–Ω–µ—Ä',score:85},{name:'–ò–Ω—Ç–µ—Ä–Ω–µ—Ç‚Äë–º–∞—Ä–∫–µ—Ç–æ–ª–æ–≥',score:70},{name:'–ú–µ–Ω–µ–¥–∂–µ—Ä –ø—Ä–æ–µ–∫—Ç–æ–≤',score:50},{name:'–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫',score:35},{name:'–ê–Ω–∞–ª–∏—Ç–∏–∫ –¥–∞–Ω–Ω—ã—Ö',score:20},{name:'–ò–Ω–∂–µ–Ω–µ—Ä –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é',score:15}], notable:['–ú—ç—Ä–∏–ª–∏–Ω –ú–æ–Ω—Ä–æ','–ê–¥–µ–ª—å','–≠–ª—Ç–æ–Ω –î–∂–æ–Ω'] };

  // ===== State =====
  let state = { name:'', answers:Array(QUESTIONS.length).fill(null), step:0, seed: Math.random().toString(36).slice(2) };

  // ===== DOM refs =====
  const intro = $('#intro');
  const quiz = $('#quiz');
  const results = $('#results');
  const questionsWrap = $('#questionsWrap');
  const stepNow = $('#stepNow');
  const stepAll = $('#stepAll');
  const progressFill = $('#progressFill');

  // ===== Init =====
  $('#year').textContent = new Date().getFullYear();
  stepAll.textContent = STEPS;

  $('#startBtn')?.addEventListener('click', ()=>{ state.name = $('#userName').value.trim(); startTest(); });
  $('#restoreBtn')?.addEventListener('click', restore);
  $('#wipeBtn')?.addEventListener('click', ()=>{try{localStorage.removeItem('proftest-v1');}catch{} alert('–î–∞–Ω–Ω—ã–µ —É–¥–∞–ª–µ–Ω—ã.');});

  $('#prevBtn')?.addEventListener('click', ()=>{ if(state.step>0){state.step--; renderPage();} });
  $('#nextBtn')?.addEventListener('click', nextOrFinish);
  $('#saveBtn')?.addEventListener('click', save);
  $('#againBtn')?.addEventListener('click', ()=>{state={...state,answers:Array(QUESTIONS.length).fill(null),step:0}; show(quiz); hide(results); renderPage(); window.scrollTo({top:0,behavior:'smooth'});});
  $('#printBtn')?.addEventListener('click', downloadPdf);

  // –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ iOS –º–æ–∂–µ—Ç –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—Ç—å –¥–æ–∫-–±–∞—Ä ‚Äî —Å–∫—Ä–æ–ª–ª–∏–º –∫ –∞–∫—Ç—É–∞–ª—å–Ω–æ–º—É –≤–æ–ø—Ä–æ—Å—É –ø—Ä–∏ —Ñ–æ–∫—É—Å–µ –Ω–∞ –∏–Ω–ø—É—Ç–µ –∏–º–µ–Ω–∏
  $('#userName')?.addEventListener('focus', e=>{ setTimeout(()=>e.target.scrollIntoView({block:'center',behavior:'smooth'}), 250); });

  document.addEventListener('keydown', (e)=>{
    if(results.hidden) {
      if(e.key==='ArrowRight') nextOrFinish();
      if(e.key==='ArrowLeft')  { if(state.step>0){state.step--; renderPage();} }
    }
  });

  function startTest(){ hide(intro); show(quiz); renderPage(); }

  function save(){ try{localStorage.setItem('proftest-v1', JSON.stringify(state)); showToast('–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ');}catch{showToast('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å');} }
  function restore(){
    let raw=null; try{ raw = localStorage.getItem('proftest-v1'); }catch{}
    if(!raw){showToast('–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–π –Ω–µ—Ç');return;}
    try{ state = JSON.parse(raw); $('#userName').value = state.name||''; hide(intro); show(quiz); renderPage(); showToast('–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ'); }
    catch{ showToast('–ù–µ —É–¥–∞–ª–æ—Å—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å'); }
  }

  function showToast(text){ const t = document.createElement('div'); t.textContent = text; t.style.position='fixed'; t.style.bottom='calc(20px + var(--safe-b))'; t.style.left='50%'; t.style.transform='translateX(-50%)'; t.style.background='#111827'; t.style.color='#e5e7eb'; t.style.padding='10px 14px'; t.style.borderRadius='10px'; t.style.border='1px solid #374151'; t.style.boxShadow= '0 10px 20px rgba(0,0,0,.35)'; t.style.zIndex=9999; document.body.appendChild(t); setTimeout(()=>t.remove(), 1600); }

  function show(el){ el.hidden=false; }
  function hide(el){ el.hidden=true; }

  function renderPage(){
    stepNow.textContent = state.step+1;
    progressFill.style.width = (100*(state.step)/STEPS) + '%';

    const start = state.step*PAGE_SIZE;
    const slice = QUESTIONS.slice(start, start+PAGE_SIZE);

    questionsWrap.innerHTML = '';

    slice.forEach((q, idx)=>{
      const i = start+idx;
      const card = document.createElement('div'); card.className = 'card';
      const scaleHtml = [1,2,3,4,5,6,7].map(val=>{
        const id = `q${i}_${val}`;
        const checked = state.answers[i]===val? 'checked' : '';
        const aria = val===1? '–°–æ–≤–µ—Ä—à–µ–Ω–Ω–æ –Ω–µ —Å–æ–≥–ª–∞—Å–µ–Ω' : val===7? '–ü–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≥–ª–∞—Å–µ–Ω' : `–í–∞—Ä–∏–∞–Ω—Ç ${val}`;
        return `<div class="pill"><input type="radio" name="q${i}" id="${id}" ${checked} aria-label="${aria}"/>\
                <label for="${id}">${val}</label></div>`;
      }).join('');

      card.innerHTML = `
        <div class="inner">
          <div class="likert">
            <div>
              <div class="muted">${String(i+1).padStart(2,'0')}</div>
              <div class="q">${q.text}</div>
            </div>
            <div>
              <div class="scale" role="radiogroup" aria-label="–®–∫–∞–ª–∞ —Å–æ–≥–ª–∞—Å–∏—è">${scaleHtml}</div>
              <div class="legend"><span>—Å–æ–≤—Å–µ–º –Ω–µ—Ç</span><span>–¥–∞, –ø–æ–ª–Ω–æ—Å—Ç—å—é</span></div>
            </div>
          </div>
        </div>`;

      card.addEventListener('change', (e)=>{
        if(e.target && e.target.matches('input[type="radio"]')){
          const id = e.target.id; const val = parseInt(id.split('_')[1],10);
          state.answers[i] = val; save();
        }
      });

      questionsWrap.appendChild(card);
    });

    $('#prevBtn').disabled = state.step===0;
    $('#nextBtn').textContent = (state.step===STEPS-1? '–ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç' : '–î–∞–ª–µ–µ ‚Üí');
  }

  function nextOrFinish(){
    const start = state.step*PAGE_SIZE;
    const need = QUESTIONS.slice(start, start+PAGE_SIZE).map((_,i)=>state.answers[start+i]);
    if(need.some(v=>v===null)) { showToast('–û—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ –≤—Å–µ —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –Ω–∞ —ç—Ç–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ'); return; }
    if(state.step < STEPS-1){ state.step++; renderPage(); const y = Math.max(0, questionsWrap.getBoundingClientRect().top + window.scrollY - 80); window.scrollTo({top:y,behavior:'smooth'}); }
    else { finalize(); }
  }

  function finalize(){ const report = buildReport(); renderResults(report); hide(quiz); show(results); const y = Math.max(0, results.getBoundingClientRect().top + window.scrollY - 80); window.scrollTo({top:y,behavior:'smooth'}); }

  function buildReport(){
    const sums = {E:0,I:0,S:0,N:0,F:0,T:0,P:0,J:0}; const facets = {};
    QUESTIONS.forEach((q, idx)=>{
      const raw = state.answers[idx]; const centered = raw - 4; const delta = centered * q.key;
      if(q.axis==='E'){ sums.E += Math.max(0,delta); sums.I += Math.max(0,-delta); }
      if(q.axis==='S'){ sums.S += Math.max(0,delta); sums.N += Math.max(0,-delta); }
      if(q.axis==='F'){ sums.F += Math.max(0,delta); sums.T += Math.max(0,-delta); }
      if(q.axis==='P'){ sums.P += Math.max(0,delta); sums.J += Math.max(0,-delta); }
      if(!facets[q.facet]) facets[q.facet] = {sum:0,count:0,axis:q.axis}; facets[q.facet].sum += raw; facets[q.facet].count += 1;
    });

    const axisPairs = [ ['E','I'], ['S','N'], ['F','T'], ['P','J'] ]; const perc = {};
    const letters = axisPairs.map(([a,b])=>{ const total = sums[a] + sums[b]; const pa = total ? Math.round(100 * sums[a]/total) : 50; const pb = 100 - pa; perc[a] = pa; perc[b] = pb; return pa>=pb ? a : b; });
    const code = letters.join('');
    const facetArr = Object.entries(facets).map(([k,v])=>({name:k,axis:v.axis,score:Math.round((v.sum/v.count-1)/6*100)}));
    return { name: state.name, code, perc, facetArr, answers:[...state.answers] };
  }

  function renderResults(r){
    const seed = seedRand((state.name||'user')+state.seed+r.code);
    const code = r.code; const name = TYPE_NAMES[code] || '–†–∞–±–æ—á–∏–π —Å—Ç–∏–ª—å';
    const tl = TAGLINES[code]||['–ë–∞–ª–∞–Ω—Å —Å–∏–ª—å–Ω—ã—Ö —Å—Ç–æ—Ä–æ–Ω']; const tagline = tl[Math.floor(seed()*tl.length)];

    $('#typeCode').textContent = code; $('#typeName').textContent = name; $('#tagline').textContent = tagline;

    const hello = state.name ? `${state.name}, –≤–∞—à –ø—Ä–æ—Ñ–∏–ª—å: ` : '–í–∞—à –ø—Ä–æ—Ñ–∏–ª—å: ';
    const intros = ['—Å–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã —É–∂–µ –Ω–∞ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏, –∞ —Ç–æ—á–∫–∏ —Ä–æ—Å—Ç–∞ ‚Äî —Ä—è–¥–æ–º —Å –Ω–∏–º–∏.','–≤—ã —Ö–æ—Ä–æ—à–æ —á—É–≤—Å—Ç–≤—É–µ—Ç–µ –ª—é–¥–µ–π –∏ –∑–∞–¥–∞—á–∏, –æ—Å—Ç–∞–ª–æ—Å—å –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–µ–∂–∏–º –∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã.','–±–∞–ª–∞–Ω—Å —ç–º–æ—Ü–∏–π –∏ —Ñ–∞–∫—Ç–æ–≤ –≤ –≤–∞—à–∏—Ö —Ä—É–∫–∞—Ö; –≥–ª–∞–≤–Ω–æ–µ ‚Äî —É–ø—Ä–∞–≤–ª—è—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ–º –∏ –≤—Ä–µ–º–µ–Ω–µ–º.'];
    $('#summary').textContent = hello + name + '. ' + intros[Math.floor(seed()*intros.length)];

    // –ò–º—è –¥–ª—è –ø–µ—á–∞—Ç–∏/—ç–∫—Ä–∞–Ω–∞
    $('#personName').textContent = state.name || '‚Äî';
    $('#printName').textContent  = state.name || '‚Äî';
    $('#printDate').textContent  = new Date().toLocaleDateString('ru-RU');

    const bars = $('#axesBars'); bars.innerHTML = '';
    const labels = {E:'–≠–∫—Å—Ç—Ä–∞–≤–µ—Ä—Å–∏—è',I:'–ò–Ω—Ç—Ä–æ–≤–µ—Ä—Å–∏—è',S:'–°–µ–Ω—Å–æ—Ä–∏–∫–∞',N:'–ò–Ω—Ç—É–∏—Ü–∏—è',F:'–ß—É–≤—Å—Ç–≤–æ',T:'–õ–æ–≥–∏–∫–∞',P:'–í–æ—Å–ø—Ä–∏—è—Ç–∏–µ',J:'–°—É–∂–¥–µ–Ω–∏–µ'};
    [['E','I'],['S','N'],['F','T']].forEach(([a,b])=>{ bars.appendChild(bar(labels[a], r.perc[a])); bars.appendChild(bar(labels[b], r.perc[b])); });
    // keep order of bars P/J last
    ;[['P','J']].forEach(([a,b])=>{ bars.appendChild(bar(labels[a], r.perc[a])); bars.appendChild(bar(labels[b], r.perc[b])); });

    const strengths = $('#strengths'); strengths.innerHTML=''; const advice = $('#advice'); advice.innerHTML='';
    let strengthsList = [], growthList = [], envTags = [], jobs = [];
    if(code==='ESFP'){ strengthsList = ESFP_DETAIL.strengths; growthList = ESFP_DETAIL.growth; envTags = ESFP_DETAIL.env; jobs = ESFP_DETAIL.jobs; }
    else { strengthsList = genStrengths(r); growthList = genGrowth(r); envTags = genEnv(r); jobs = genJobs(r); }

    strengthsList.forEach(s=>strengths.appendChild(tag(s)));
    const envWrap = $('#envTags'); envWrap.innerHTML=''; envTags.forEach(s=>envWrap.appendChild(tag(s)));
    advice.append(...growthList.map(text=>{const li=document.createElement('li'); li.textContent=text; return li;}));

    const jobsWrap = $('#jobs'); jobsWrap.innerHTML='';
    jobs.slice(0,8).forEach(j=>{ const d = document.createElement('div'); d.className='job'; d.innerHTML = `<div class='p' aria-hidden='true'><div style='width:${j.score}%'></div></div><div><strong>${j.name}</strong><div class='note'>–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ ~${j.score}%</div></div><div class='muted' style='text-align:right'>${j.score}%</div>`; jobsWrap.appendChild(d); });

    const dd = $('#deepDive'); dd.innerHTML = deepDiveHTML(r, seed);
  }

  function bar(label, val){ const d = document.createElement('div'); d.className='bar'; d.innerHTML = `<div class='muted'>${label}</div><div class='track'><div class='fill' style='width:${clamp(val)}%'></div></div><div>${clamp(val)}%</div>`; return d; }
  function tag(text){ const s=document.createElement('span'); s.className='tag'; s.textContent=text; return s; }

  function genStrengths(r){ const out=[]; if(r.perc.E>=60) out.push('–ö–æ–º–º—É–Ω–∏–∫–∞–±–µ–ª—å–Ω–æ—Å—Ç—å –∏ –±—ã—Å—Ç—Ä—ã–π —Ä–∞–ø–ø–æ—Ä—Ç'); else out.push('–ì–ª—É–±–æ–∫–∞—è —Ñ–æ–∫—É—Å–∏—Ä–æ–≤–∫–∞ –∏ –∫–∞—á–µ—Å—Ç–≤–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π'); if(r.perc.S>=60) out.push('–ü—Ä–∞–∫—Ç–∏—á–Ω–æ—Å—Ç—å –∏ –≤–Ω–∏–º–∞–Ω–∏–µ –∫ –¥–µ—Ç–∞–ª—è–º'); else out.push('–í–∏–¥–µ–Ω–∏–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–π –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π'); if(r.perc.F>=60) out.push('–≠–º–ø–∞—Ç–∏—è –∏ –∫–æ–º–∞–Ω–¥–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞'); else out.push('–°—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ–µ –º—ã—à–ª–µ–Ω–∏–µ –∏ —è—Å–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è'); if(r.perc.P>=60) out.push('–ì–∏–±–∫–æ—Å—Ç—å –∏ –∞–¥–∞–ø—Ç–∞—Ü–∏—è –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º'); else out.push('–°–∏—Å—Ç–µ–º–Ω–æ—Å—Ç—å –∏ –¥–æ–≤–µ–¥–µ–Ω–∏–µ –¥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞'); return out; }
  function genGrowth(r){ const out=[]; if(r.perc.E>=60) out.push('–û—Å—Ç–∞–≤–ª—è–π—Ç–µ –æ–∫–Ω–∞ —Ç–∏—à–∏–Ω—ã –¥–ª—è –≥–ª—É–±–æ–∫–∏—Ö –∑–∞–¥–∞—á'); else out.push('–ü–ª–∞–Ω–∏—Ä—É–π—Ç–µ –∫–æ—Ä–æ—Ç–∫–∏–µ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–ª–æ—Ç—ã, —á—Ç–æ–±—ã –Ω–µ –≤—ã–ø–∞–¥–∞—Ç—å –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞'); if(r.perc.S>=60) out.push('–†–∞–∑ –≤ –Ω–µ–¥–µ–ª—é ‚Äî ¬´–ø–æ–ª—ë—Ç –º—ã—Å–ª–µ–π¬ª: –≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –¥–∞–ª—å–Ω–∏–µ –≥–∏–ø–æ—Ç–µ–∑—ã'); else out.push('–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –∏–¥–µ–∏ –ø–∏–ª–æ—Ç–∞–º–∏ –∏ —Ñ–∞–∫—Ç–∞–º–∏'); if(r.perc.F>=60) out.push('–î–æ–≥–æ–≤–æ—Ä–∏—Ç–µ—Å—å —Å —Å–æ–±–æ–π: –∫—Ä–∏—Ç–∏–∫–∞ ‚Äî –ø—Ä–æ –∑–∞–¥–∞—á—É, –Ω–µ –ø—Ä–æ –ª–∏—á–Ω–æ—Å—Ç—å'); else out.push('–ü–æ–º–Ω–∏—Ç–µ –æ –≤–ª–∏—è–Ω–∏–∏ —Ä–µ—à–µ–Ω–∏–π –Ω–∞ –ª—é–¥–µ–π –∏ –∞—Ç–º–æ—Å—Ñ–µ—Ä—É'); if(r.perc.P>=60) out.push('–î–µ–ª–∏—Ç–µ —Ü–µ–ª–∏ –Ω–∞ —á–µ–∫‚Äë–ø—É–Ω–∫—Ç—ã –∏ —Å—Ç–∞–≤—å—Ç–µ –º—è–≥–∫–∏–µ –¥–µ–¥–ª–∞–π–Ω—ã —Ä–∞–Ω—å—à–µ –∂—ë—Å—Ç–∫–∏—Ö'); else out.push('–û—Å—Ç–∞–≤–ª—è–π—Ç–µ 10% –±—É—Ñ–µ—Ä–∞ –Ω–∞ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω—ã–µ –ø–æ–≤–æ—Ä–æ—Ç—ã'); return out; }
  function genEnv(r){ const out=[]; out.push(r.perc.E>=60? '–ñ–∏–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ' : '–¢–∏—Ö–∏–µ –∑–æ–Ω—ã –∏ –≥–ª—É–±–æ–∫–∞—è —Ä–∞–±–æ—Ç–∞'); out.push(r.perc.S>=60? '–ö–æ–Ω–∫—Ä–µ—Ç–∏–∫–∞ –∏ –∏–∑–º–µ—Ä–∏–º—ã–µ –∑–∞–¥–∞—á–∏' : '–ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ä–∞–±–æ—Ç–∞ —Å –≥–∏–ø–æ—Ç–µ–∑–∞–º–∏'); out.push(r.perc.P>=60? '–ú–∏–Ω–∏–º—É–º —Ä–µ–≥–ª–∞–º–µ–Ω—Ç–æ–≤' : '–ß—ë—Ç–∫–∏–µ –ø—Ä–∞–≤–∏–ª–∞ –∏ –ø—Ä–æ—Ü–µ—Å—Å—ã'); out.push(r.perc.F>=60? '–î–æ–±—Ä–æ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–∞—è –∫—É–ª—å—Ç—É—Ä–∞' : '–î–∞–Ω–Ω—ã–µ, –º–µ—Ç—Ä–∏–∫–∏ –∏ –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–µ –∫—Ä–∏—Ç–µ—Ä–∏–∏'); return out; }
  function genJobs(r){ const items = [ {name:'HR‚Äë—Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç', w:(r.perc.E+r.perc.F)/2}, {name:'–ì—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π –¥–∏–∑–∞–π–Ω–µ—Ä', w:(r.perc.S*0.4 + r.perc.F*0.6)}, {name:'–ò–Ω—Ç–µ—Ä–Ω–µ—Ç‚Äë–º–∞—Ä–∫–µ—Ç–æ–ª–æ–≥', w:(r.perc.E*0.5 + (100-r.perc.S)*0.5)}, {name:'–ú–µ–Ω–µ–¥–∂–µ—Ä –ø—Ä–æ–µ–∫—Ç–æ–≤', w:(((100-r.perc.P))*0.6 + r.perc.E*0.4)}, {name:'–ü—Ä–æ–¥—É–∫—Ç–æ–≤—ã–π –∞–Ω–∞–ª–∏—Ç–∏–∫', w:(((100-r.perc.F))*0.6 + (100-r.perc.S)*0.4)}, {name:'Frontend‚Äë—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫', w:(r.perc.S*0.5 + (100-r.perc.P)*0.5)}, {name:'UX‚Äë–∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å', w:(((100-r.perc.S))*0.5 + r.perc.F*0.5)}, {name:'QA‚Äë–∏–Ω–∂–µ–Ω–µ—Ä', w:(r.perc.S*0.6 + (100-r.perc.P)*0.4)}, {name:'–ü—Ä–æ–¥—é—Å–µ—Ä –∫–æ–Ω—Ç–µ–Ω—Ç–∞', w:(r.perc.E*0.5 + r.perc.P*0.5)}, {name:'Data Scientist', w:((100-r.perc.F)*0.7 + (100-r.perc.S)*0.3)} ]; return items.map(x=>({name:x.name, score:Math.round(clamp(x.w))})).sort((a,b)=>b.score-a.score); }

  function deepDiveHTML(r, seed){
    const dic = { E:['–æ–±—â–µ–Ω–∏–µ','–∏–Ω–∏—Ü–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å','–∏–º–ø—Ä–æ–≤–∏–∑–∞—Ü–∏—è','–≤–ª–∏—è–Ω–∏–µ'], I:['—Ñ–æ–∫—É—Å','—Ä–µ—Ñ–ª–µ–∫—Å–∏—è','–≥–ª—É–±–∏–Ω–∞','–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ'], S:['–¥–µ—Ç–∞–ª–∏','–ø—Ä–∞–∫—Ç–∏—á–Ω–æ—Å—Ç—å','—Ç–æ—á–Ω–æ—Å—Ç—å','–æ–ø—ã—Ç'], N:['–∏–¥–µ–∏','–≥–∏–ø–æ—Ç–µ–∑—ã','—Ä–∏—Å–∫–∏','–≤–∏–¥–µ–Ω–∏–µ'], F:['—ç–º–ø–∞—Ç–∏—è','–ø–æ–¥–¥–µ—Ä–∂–∫–∞','–≥–∞—Ä–º–æ–Ω–∏—è','—Ü–µ–Ω–Ω–æ—Å—Ç–∏'], T:['–ª–æ–≥–∏–∫–∞','—Å—Ç—Ä—É–∫—Ç—É—Ä–∞','–æ–±—ä–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å','–¥–µ–±–∞—Ç—ã'], P:['–≥–∏–±–∫–æ—Å—Ç—å','–≤–∞—Ä–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å','–∞–¥–∞–ø—Ç–∞—Ü–∏—è','—Å–ø–æ–Ω—Ç–∞–Ω–Ω–æ—Å—Ç—å'], J:['—Å–∏—Å—Ç–µ–º–Ω–æ—Å—Ç—å','–¥–µ–¥–ª–∞–π–Ω—ã','–∫–æ–Ω—Ç—Ä–æ–ª—å','–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å'] };
    const map = [['E','I'],['S','N'],['F','T'],['P','J']];
    const pick=(a)=>a[Math.floor(seed()*a.length)];
    const bullets = map.map(([a,b])=>{ const ap=r.perc[a], bp=r.perc[b]; const lead = ap>bp? dic[a]:dic[b]; const tune = ap>bp? pick(['–¥–æ–±–∞–≤–ª—è–π—Ç–µ —Ç–∏—à–∏–Ω—ã –∏ –ø–∞—É–∑','—Ñ–∏–∫—Å–∏—Ä—É–π—Ç–µ –¥–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–∏ –ø–∏—Å—å–º–µ–Ω–Ω–æ','–ø–µ—Ä–µ–≤–æ–¥–∏—Ç–µ –∏–º–ø—É–ª—å—Å –≤ –∫–æ—Ä–æ—Ç–∫–∏–µ —Å–ø—Ä–∏–Ω—Ç—ã']) : pick(['–ø–ª–∞–Ω–∏—Ä—É–π—Ç–µ –∂–∏–≤—ã–µ –æ–±—Å—É–∂–¥–µ–Ω–∏—è','–ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –≥–∏–ø–æ—Ç–µ–∑—ã –Ω–∞ –ª—é–¥—è—Ö','–¥–µ–ª–∞–π—Ç–µ –¥–µ–º–æ‚Äë–¥–Ω–∏']); return `<li><strong>${a}/${b}</strong>: –ø—Ä–µ–æ–±–ª–∞–¥–∞–µ—Ç <em>${ap>bp?a:b}</em> ‚Äî —ç—Ç–æ –ø—Ä–æ ${pick(lead)} –∏ ${pick(lead)}. –ù–∞—Å—Ç—Ä–æ–π–∫–∞: ${tune}.</li>` }).join('');
    const facetsTop = r.facetArr.sort((a,b)=>b.score-a.score).slice(0,5).map(f=>`<span class='tag'>${f.name}: ${f.score}%</span>`).join('');
    const notable = (r.code==='ESFP')? `<div class='note'>–í–∞–º, –≤–µ—Ä–æ—è—Ç–Ω–æ, –±–ª–∏–∑–∫–∏ –∞—Ä—Ç–∏—Å—Ç—ã‚Äë—ç–∫—Å—Ç—Ä–∞–≤–µ—Ä—Ç—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, ${ESFP_DETAIL.notable.join(', ')}).</div>`:'';
    return `<div class='two-col'><div><h4>–°–º—ã—Å–ª –≤–∞—à–µ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è</h4><ul>${bullets}</ul>${notable}</div><div><h4>–§–∞–∫—Ç–æ—Ä—ã, –≤—ã–¥–µ–ª—è—é—â–∏–µ—Å—è –≤ –æ—Ç–≤–µ—Ç–∞—Ö</h4><div class='row'>${facetsTop}</div></div></div>`;
  }

  // ===== PDF Composer =====
  function buildPdfSheet(r){
    const seed = seedRand((state.name||'user')+state.seed+r.code);
    const code = r.code; const name = TYPE_NAMES[code] || '–†–∞–±–æ—á–∏–π —Å—Ç–∏–ª—å';
    const tl = TAGLINES[code]||['–ë–∞–ª–∞–Ω—Å —Å–∏–ª—å–Ω—ã—Ö —Å—Ç–æ—Ä–æ–Ω']; const tagline = tl[Math.floor(seed()*tl.length)];

    let strengthsList = [], growthList = [], envTags = [], jobs = [];
    if(code==='ESFP'){ strengthsList = ESFP_DETAIL.strengths; growthList = ESFP_DETAIL.growth; envTags = ESFP_DETAIL.env; jobs = ESFP_DETAIL.jobs; }
    else { strengthsList = genStrengths(r); growthList = genGrowth(r); envTags = genEnv(r); jobs = genJobs(r); }

    const labels = {E:'–≠–∫—Å—Ç—Ä–∞–≤–µ—Ä—Å–∏—è',I:'–ò–Ω—Ç—Ä–æ–≤–µ—Ä—Å–∏—è',S:'–°–µ–Ω—Å–æ—Ä–∏–∫–∞',N:'–ò–Ω—Ç—É–∏—Ü–∏—è',F:'–ß—É–≤—Å—Ç–≤–æ',T:'–õ–æ–≥–∏–∫–∞',P:'–í–æ—Å–ø—Ä–∏—è—Ç–∏–µ',J:'–°—É–∂–¥–µ–Ω–∏–µ'};
    const barsHtml = ['E','I','S','N','F','T','P','J'].map(k=>{
      return `<div class="pbar"><div><div class="track"><div class="fill" style="width:${clamp(r.perc[k])}%"></div></div><div class="small" style="font-size:10px;color:#ffffff;margin-top:2px">${labels[k]}</div></div><div style="text-align:right;font-size:10px">${clamp(r.perc[k])}%</div></div>`;
    }).join('');

    const strengthsHtml = strengthsList.map(s=>`<span class="tag">${s}</span>`).join('');
    const envHtml = envTags.map(s=>`<span class="tag">${s}</span>`).join('');
    const adviceHtml = growthList.slice(0,6).map(s=>`<li>${s}</li>`).join('');
    const jobsHtml = jobs.slice(0,8).map(j=>`
      <div class="job">
        <div>
          <div class="track"><div class="fill" style="width:${j.score}%"></div></div>
          <div class="small" style="font-size:10px;color:#ffffff;margin-top:2px">${j.name}</div>
        </div>
        <div style="text-align:right;font-size:10px">${j.score}%</div>
      </div>
    `).join('');

    const ddSeed = seed; // reuse for deep dive
    const dic = { E:['–æ–±—â–µ–Ω–∏–µ','–∏–Ω–∏—Ü–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å','–∏–º–ø—Ä–æ–≤–∏–∑–∞—Ü–∏—è','–≤–ª–∏—è–Ω–∏–µ'], I:['—Ñ–æ–∫—É—Å','—Ä–µ—Ñ–ª–µ–∫—Å–∏—è','–≥–ª—É–±–∏–Ω–∞','–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ'], S:['–¥–µ—Ç–∞–ª–∏','–ø—Ä–∞–∫—Ç–∏—á–Ω–æ—Å—Ç—å','—Ç–æ—á–Ω–æ—Å—Ç—å','–æ–ø—ã—Ç'], N:['–∏–¥–µ–∏','–≥–∏–ø–æ—Ç–µ–∑—ã','—Ä–∏—Å–∫–∏','–≤–∏–¥–µ–Ω–∏–µ'], F:['—ç–º–ø–∞—Ç–∏—è','–ø–æ–¥–¥–µ—Ä–∂–∫–∞','–≥–∞—Ä–º–æ–Ω–∏—è','—Ü–µ–Ω–Ω–æ—Å—Ç–∏'], T:['–ª–æ–≥–∏–∫–∞','—Å—Ç—Ä—É–∫—Ç—É—Ä–∞','–æ–±—ä–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å','–¥–µ–±–∞—Ç—ã'], P:['–≥–∏–±–∫–æ—Å—Ç—å','–≤–∞—Ä–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å','–∞–¥–∞–ø—Ç–∞—Ü–∏—è','—Å–ø–æ–Ω—Ç–∞–Ω–Ω–æ—Å—Ç—å'], J:['—Å–∏—Å—Ç–µ–º–Ω–æ—Å—Ç—å','–¥–µ–¥–ª–∞–π–Ω—ã','–∫–æ–Ω—Ç—Ä–æ–ª—å','–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å'] };
    const map = [['E','I'],['S','N'],['F','T'],['P','J']];
    const pick=(a)=>a[Math.floor(ddSeed()*a.length)];
    const deepBullets = map.map(([a,b])=>{ const ap=r.perc[a], bp=r.perc[b]; const lead = ap>bp? dic[a]:dic[b]; const tune = ap>bp? pick(['–¥–æ–±–∞–≤–ª—è–π—Ç–µ —Ç–∏—à–∏–Ω—ã –∏ –ø–∞—É–∑','—Ñ–∏–∫—Å–∏—Ä—É–π—Ç–µ –¥–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–∏ –ø–∏—Å—å–º–µ–Ω–Ω–æ','–ø–µ—Ä–µ–≤–æ–¥–∏—Ç–µ –∏–º–ø—É–ª—å—Å –≤ –∫–æ—Ä–æ—Ç–∫–∏–µ —Å–ø—Ä–∏–Ω—Ç—ã']) : pick(['–ø–ª–∞–Ω–∏—Ä—É–π—Ç–µ –∂–∏–≤—ã–µ –æ–±—Å—É–∂–¥–µ–Ω–∏—è','–ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –≥–∏–ø–æ—Ç–µ–∑—ã –Ω–∞ –ª—é–¥—è—Ö','–¥–µ–ª–∞–π—Ç–µ –¥–µ–º–æ‚Äë–¥–Ω–∏']); return `<li><strong>${a}/${b}</strong>: –ø—Ä–µ–æ–±–ª–∞–¥–∞–µ—Ç <em>${ap>bp?a:b}</em> ‚Äî ${pick(lead)}; –Ω–∞—Å—Ç—Ä–æ–π–∫–∞: ${tune}.</li>` }).join('');

    const facetsTop = r.facetArr.sort((a,b)=>b.score-a.score).slice(0,6).map(f=>`<span class="tag">${f.name}: ${f.score}%</span>`).join('');

    const sheet = document.getElementById('pdfSheet');
    const today = new Date().toLocaleDateString('ru-RU');
    const hello = state.name ? state.name : '‚Äî';
    sheet.innerHTML = `
      <div class="h1">–ü—Ä–æ—Ñ–¢–µ—Å—Ç by @Ave7Eva‚Äî –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞</div>
      <div class="sub">–ò–º—è: <strong>${hello}</strong> ¬∑ –î–∞—Ç–∞: ${today}</div>
      <div style="margin-bottom:8px;display:flex;align-items:center;gap:8px;flex-wrap:wrap">
        <span class="chip"><strong>${code}</strong> <small>${name}</small></span>
        <span class="tag">${tagline}</span>
      </div>

      <div class="grid">
        <div class="card">
          <h3>–†–∞–∑–ª–æ–∂–µ–Ω–∏–µ –ø–æ –æ—Å—è–º</h3>
          <div class="bars">${barsHtml}</div>

          <h3 style="margin-top:10px">–ö–ª—é—á–µ–≤—ã–µ –∫–∞—á–µ—Å—Ç–≤–∞</h3>
          <div class="tags">${strengthsHtml}</div>

          <h3 style="margin-top:10px">–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–≤–µ—Ç—ã</h3>
          <ul class="compact">${adviceHtml}</ul>
        </div>

        <div class="card">
          <h3>–ü—Ä–æ—Ñ–Ω–∞–≤–∏–≥–∞—Ü–∏—è</h3>
          <div class="jobs">${jobsHtml}</div>
          <h3 style="margin-top:10px">–°—Ä–µ–¥–∞ –¥–ª—è —Ä–æ—Å—Ç–∞</h3>
          <div class="tags">${envHtml}</div>
        </div>
      </div>

      <div class="card" style="margin-top:10px">
        <div class="cols2">
          <div>
            <h3>–ò–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π —Ä–∞–∑–±–æ—Ä</h3>
            <ul class="compact">${deepBullets}</ul>
          </div>
          <div>
            <h3>–§–∞–∫—Ç–æ—Ä—ã, –≤—ã–¥–µ–ª—è—é—â–∏–µ—Å—è –≤ –æ—Ç–≤–µ—Ç–∞—Ö</h3>
            <div class="tags">${facetsTop}</div>
            ${code==='ESFP' ? `<div class="note">–ë–ª–∏–∑–∫–∏–µ —Ä–µ—Ñ–µ—Ä–µ–Ω—Å—ã: ${ESFP_DETAIL.notable.join(', ')}.</div>` : ''}
          </div>
        </div>
      </div>
    `;
  }

  // ===== Download as PNG (converted from previous PDF flow) =====
  async function downloadPdf() {
    // 1) –°–æ–±–∏—Ä–∞–µ–º –æ—Ç—á—ë—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ
    const report = buildReport();
    buildPdfSheet(report);
    const element = document.getElementById("pdfSheet");

    // 2) –†–µ–Ω–¥–µ—Ä–∏–º —Å–ª–æ–π –≤ canvas
    const canvas = await html2canvas(element, { scale: 2, backgroundColor: null });

    // 3) –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–∞–∫ PNG –≤–º–µ—Å—Ç–æ PDF
    await new Promise((resolve)=>{
      canvas.toBlob((blob)=>{
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = "proftest-result.png";
        document.body.appendChild(a);
        a.click();
        URL.revokeObjectURL(a.href);
        a.remove();
        resolve();
      }, 'image/png', 1);
    });

    // 4) –û—á–∏—Å—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Å–ª–æ—è
    element.innerHTML = '';
  }
  </script>
<div id="pdfSheet"></div>
<!-- PDF libs (–æ—Å—Ç–∞–≤–ª—è–µ–º, —á—Ç–æ–±—ã –Ω–µ —Ç—Ä–æ–≥–∞—Ç—å –æ–∫—Ä—É–∂–µ–Ω–∏–µ/–º–µ—Ö–∞–Ω–∏–∫—É) -->
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
</body>
</html>
